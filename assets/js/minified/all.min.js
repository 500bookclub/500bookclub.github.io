function showLoading(){document.querySelector(".pageloader").classList.add("is-active")}function hideLoading(){document.querySelector(".pageloader").classList.remove("is-active")}function getQueryParam(t){let e;var o,i=window.location.href.split("?")[1];for(o of new URLSearchParams(i).entries())o[0]===t&&(e=o[1]);return e}function attachFieldEvents(t){for(const e of t.querySelectorAll("input, select, textarea"))e.addEventListener("input",function(){e.setCustomValidity(""),e.reportValidity(),e.classList.remove("invalid")}),e.addEventListener("keyup",function(){e.setCustomValidity(""),e.reportValidity(),e.classList.remove("invalid")})}const projectName=window.site.title;window.activationPage="activate",window.passwdPage="passwd";class csystem{constructor(){this.GIT_CLIENT_ID=window.site.CLIENT_IDS.GITHUB,this.IN_CLIENT_ID=window.site.CLIENT_IDS.LINKEDIN,this.TWITTER_CLIENT_ID=window.site.CLIENT_IDS.TWITTER,this.FB_CLIENT_ID=window.site.CLIENT_IDS.FACEBOOK,this.baseUrl=window.location.protocol+"//"+window.location.host+window.site.baseurl,this.tokenName=projectName+"TokenGSAC",this.refreshTokenName=projectName+"refreshTokenGSAC";try{document.querySelector("#forgotPasswdSubmit").addEventListener("click",t=>{this.submitResetpassword(t)})}catch(t){}try{document.querySelector("#loginwithGithub").addEventListener("click",t=>{this.loginWithGitHub(t)})}catch(t){console.error(t)}try{document.querySelector("#loginWithLinkedIn").addEventListener("click",t=>{this.loginWithLinkedIn(t)})}catch(t){}try{document.querySelector("#loginWithFb").addEventListener("click",t=>{this.loginWithFb(t)})}catch(t){console.error(t)}try{document.querySelector("#loginWithTwitter").addEventListener("click",t=>{this.loginWithTwitter(t)})}catch(t){}}setlastWinLocation=()=>{window.localStorage.setItem("lastLocation",window.location.href)};getlastWinLocation=()=>window.localStorage.getItem("lastLocation");loginWithGitHub=()=>{this.setlastWinLocation(),window.location.href=`https://github.com/login/oauth/authorize?client_id=${this.GIT_CLIENT_ID}&scope=user:email`};loginWithFb=()=>{this.setlastWinLocation(),window.location.href=`https://www.facebook.com/v2.0/dialog/oauth?client_id=${this.FB_CLIENT_ID}&scope=email&redirect_uri=${encodeURIComponent(this.baseUrl+"/facebook_login")}&state=state`};loginWithTwitter=()=>{this.setlastWinLocation(),window.location.href=`https://twitter.com/i/oauth2/authorize?response_type=code&client_id=${this.TWITTER_CLIENT_ID}&redirect_uri=${encodeURIComponent(this.baseUrl+"/twitter_login")}&scope=users.read&state=state&code_challenge=challenge&code_challenge_method=plain`};loginWithLinkedIn=()=>{window.location.href=`https://www.linkedin.com/oauth/v2/authorization?client_id=${this.IN_CLIENT_ID}&response_type=code&redirect_uri=${encodeURIComponent(this.baseUrl+"/linkedin_login")}&scope=r_liteprofile%20r_emailaddress`};goHome(){var t=window.location.origin+"/"+window.site.baseurl;window.location.href=t}failedToConnect(){this.showError("Failed to connect to server.")}unknownError(){this.showError("An unknown error occured. Trying resending or checking your email for activation code.")}showError(t){bulmaToast.toast({message:t,type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8})}showSuccess(t){bulmaToast.toast({message:t,type:"is-success",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8})}submitResetpassword(t){let n={Email:"Email",Password:"Password"};t.preventDefault();const s=document.querySelector("#forgotPasswdForm");attachFieldEvents(s);s.querySelectorAll("input, select, textarea").forEach(function(t){console.log(t),t.setCustomValidity(""),s.reportValidity()});var t=s.reportValidity();t&&(t={Email:document.querySelector("input[name='Email']").value},showLoading(),t.passwdPage=window.location.origin+"/"+window.passwdPage,fetch(window.site.API+"/api/noauth/forgotPassword",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(async t=>{hideLoading();let i={};try{i=await t.json()}catch(t){}t.ok?(bulmaToast.toast({message:"Log in successful",type:"is-success",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8}),window.csystem.setToken(i)):500===t.status?bulmaToast.toast({message:"An unknown error occured. Please try again later.",type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8}):Object.keys(i).map(t=>{var e=i[t];try{var o=s.querySelectorAll(`input[name='${n[t]}']`)[0];o.setCustomValidity(e),o.classList.add("invalid"),o.reportValidity(),bulmaToast.toast({message:e,type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8})}catch(t){}})}).catch(t=>{hideLoading(),window.csystem.failedToConnect()}))}setToken=t=>{var e=t.token,t=t.refreshToken;window.localStorage.setItem(this.tokenName,e),window.localStorage.setItem(this.refreshTokenName,t),this.jwt_token=e}}document.addEventListener("DOMContentLoaded",()=>{window.csystem=new csystem});
document.addEventListener("DOMContentLoaded",()=>{var o=document.querySelector("#docId");try{switch(o.classList[0]){case"c_activate":var e=getQueryParam("activateToken");e||(windows.csystem.showError("Activation Code not found."),window.location.href=window.location.href.split("activate")[0]),fetch(window.site.API+"/api/noauth/activate?activateToken="+e,{method:"GET"}).then(async o=>{hideLoading();let e={};try{e=await o.json()}catch(o){}var t;o.ok?(t=e.Code,window.location.href=window.location.href.split("activate")[0]+"passwd?Code="+t):500===o.status?window.csystem.unknownError():Object.keys(e).map(o=>{o=e[o];try{window.csystem.showError(o)}catch(o){}})}).catch(o=>{hideLoading(),window.csystem.failedToConnect()});break;case"passwd":case"forgotPassword":break;case"githubLogin":var t=getQueryParam("code");t||(window.csystem.showError("Github code not found."),window.location.href=window.location.href.split("github_login")[0]),fetch(`${window.site.API}/api/auth/social/github?clientID=${window.site.CLIENT_IDS.GITHUB}&Code=`+t,{method:"GET"}).then(async o=>{hideLoading();let e={};try{e=await o.json()}catch(o){}o.ok?(window.csystem.showSuccess("Log in successful"),window.csystem.setToken(e),window.location.href=window.csystem.getlastWinLocation()):500===o.status?window.csystem.showError("An unknown error occured."):Object.keys(e).map(o=>{o=e[o];try{window.csystem.showError(o)}catch(o){window.location.href=window.csystem.getlastWinLocation()}})}).catch(o=>{hideLoading(),window.csystem.failedToConnect()});break;case"linkedinLogin":var n=getQueryParam("code");n||(window.csystem.showError("LinkedIn code not found."),window.location.href=window.location.href.split("github_login")[0]),fetch(`${window.site.API}/api/auth/social/linkedin?clientID=${window.site.CLIENT_IDS.LINKEDIN}&Code=${n}&redirect_uri=`+encodeURIComponent(window.csystem.baseUrl+"/linkedin_login"),{method:"GET"}).then(async o=>{hideLoading();let e={};try{e=await o.json()}catch(o){}o.ok?(window.csystem.showSuccess("Log in successful"),window.csystem.setToken(e),window.location.href=window.csystem.getlastWinLocation()):500===o.status?window.csystem.showError("An unknown error occured."):Object.keys(e).map(o=>{o=e[o];try{window.csystem.showError(o)}catch(o){window.location.href=window.csystem.getlastWinLocation()}})}).catch(o=>{hideLoading(),window.csystem.failedToConnect()});break;case"twitterLogin":var i=getQueryParam("code");i||(window.csystem.showError("Twitter code not found."),window.location.href=window.location.href.split("github_login")[0]),fetch(`${window.site.API}/api/auth/social/twitter?clientID=${window.site.CLIENT_IDS.TWITTER}&Code=${i}&redirect_uri=`+encodeURIComponent(window.csystem.baseUrl+"/twitter_login"),{method:"GET"}).then(async o=>{hideLoading();let e={};try{e=await o.json()}catch(o){}o.ok?(window.csystem.showSuccess("Log in successful"),window.csystem.setToken(e),window.location.href=window.csystem.getlastWinLocation()):500===o.status?window.csystem.showError("An unknown error occured."):Object.keys(e).map(o=>{o=e[o];try{window.csystem.showError(o)}catch(o){window.location.href=window.csystem.getlastWinLocation()}})}).catch(o=>{hideLoading(),window.csystem.failedToConnect()});break;case"facebookLogin":var s=getQueryParam("code");s||(window.csystem.showError("Facebook code not found."),window.location.href=window.location.href.split("github_login")[0]),fetch(`${window.site.API}/api/auth/social/facebook?clientID=${window.site.CLIENT_IDS.FACEBOOK}&Code=${s}&redirect_uri=`+encodeURIComponent(window.csystem.baseUrl+"/facebook_login"),{method:"GET"}).then(async o=>{hideLoading();let e={};try{e=await o.json()}catch(o){}o.ok?(window.csystem.showSuccess("Log in successful"),window.csystem.setToken(e),window.location.href=window.csystem.getlastWinLocation()):500===o.status?window.csystem.showError("An unknown error occured."):Object.keys(e).map(o=>{o=e[o];try{window.csystem.showError(o)}catch(o){window.location.href=window.csystem.getlastWinLocation()}})}).catch(o=>{hideLoading(),window.csystem.failedToConnect()})}}catch(o){console.error(o)}});
document.addEventListener("DOMContentLoaded",()=>{function d(e){e.classList.remove("is-active")}function o(){(document.querySelectorAll(".modal")||[]).forEach(e=>{d(e)})}(document.querySelectorAll(".js-modal-trigger")||[]).forEach(e=>{var t=e.dataset.target;const d=document.getElementById(t);e.addEventListener("click",()=>{var e;e=d,o(),e.classList.add("is-active")})}),(document.querySelectorAll(".modal-background, .modal-close, .modal-card-head .delete, .modal-card-foot .button")||[]).forEach(e=>{const t=e.closest(".modal");e.addEventListener("click",()=>{d(t)})}),document.addEventListener("keydown",e=>{27===(e||window.event).keyCode&&o()})});
function attachFieldEvents(e){for(const t of e.querySelectorAll("input, select, textarea"))t.addEventListener("input",function(){t.setCustomValidity(""),t.reportValidity(),t.classList.remove("invalid")}),t.addEventListener("keyup",function(){t.setCustomValidity(""),t.reportValidity(),t.classList.remove("invalid")})}try{const d=document.querySelector("#passwdSubmit");d.addEventListener("click",function(e){let i={Code:"Code",Password:"Password"};e.preventDefault();const n=document.querySelector("#passwdForm");attachFieldEvents(n);n.querySelectorAll("input, select, textarea").forEach(function(e){e.setCustomValidity(""),n.reportValidity()});var e=n.reportValidity();e&&(document.querySelector("input[name='Password']").value!=document.querySelector("input[name='cPassword']").value?(document.querySelector("input[name='cPassword']").setCustomValidity("Passwords don't match"),n.reportValidity()):(e={Password:document.querySelector("input[name='Password']").value,Code:getQueryParam("Code")},showLoading(),e.activationPage=window.location.origin+"/"+window.activationPage,fetch(window.site.API+"/api/noauth/resetPassword",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{hideLoading();let a={};try{a=await e.json()}catch(e){}e.ok?(n.reset(),window.csystem.showSuccess("Password has been set. You can now log in"),window.csystem.goHome()):500===e.status?bulmaToast.toast({message:"An unknown error occured. Trying resending or checking your email for activation code.",type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8}):Object.keys(a).map(e=>{var t=a[e];window.csystem.showError(t);try{var o=n.querySelectorAll(`input[name='${i[e]}']`)[0];o.setCustomValidity(t),o.classList.add("invalid"),o.reportValidity()}catch(e){}})}).catch(e=>{hideLoading(),window.csystem.failedToConnect()})))})}catch(e){}
try{const a=document.querySelector("#registerSubmit"),b=document.querySelector("#loginSubmitBtn");b.addEventListener("click",function(e){let i={Email:"Email",Password:"Password"};e.preventDefault();const n=document.querySelector("#loginForm");attachFieldEvents(n);n.querySelectorAll("input, select, textarea").forEach(function(e){e.setCustomValidity(""),n.reportValidity()});var e=n.reportValidity();e&&(e={Email:document.querySelector("input[name='Email']").value,Password:document.querySelector("input[name='Password']").value},showLoading(),fetch(window.site.API+"/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{hideLoading();let a={};try{a=await e.json()}catch(e){}e.ok?(bulmaToast.toast({message:"Log in successful",type:"is-success",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8}),window.csystem.setToken(a),window.location.reload()):500===e.status?bulmaToast.toast({message:"An unknown error occured. Try signing in again.",type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8}):Object.keys(a).map(e=>{var t=a[e];try{var o=n.querySelectorAll(`input[name='${i[e]}']`)[0];o.setCustomValidity(t),o.classList.add("invalid"),o.reportValidity(),bulmaToast.toast({message:t,type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8})}catch(e){}})}).catch(e=>{hideLoading(),window.csystem.failedToConnect()}))}),a.addEventListener("click",function(e){let i={Email:"email",FirstName:"firstName",LastName:"lastName",Gender:"gender",Telephone:"phoneNumber",DateOfBirth:"dob"};e.preventDefault();const n=document.querySelector("#registrationForm");attachFieldEvents(n);n.querySelectorAll("input, select, textarea").forEach(function(e){e.setCustomValidity(""),n.reportValidity()});var e=n.reportValidity();e&&(e={Email:document.querySelector("input[name='email']").value,FirstName:document.querySelector("input[name='firstName']").value,LastName:document.querySelector("input[name='lastName']").value,Gender:document.querySelector("select[name='gender']").value,Telephone:document.querySelector("input[name='phoneNumber']").value,DateOfBirth:document.querySelector("input[name='dob']").value},showLoading(),e.activationPage=window.location.origin+"/"+window.activationPage,fetch(window.site.API+"/api/noauth/user?activationPage="+e.activationPage,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(async e=>{hideLoading();let a={};try{a=await e.json()}catch(e){bulmaToast.toast({message:"An unknown error occured. Trying resending or checking your email for activation code.",type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8})}e.ok?(bulmaToast.toast({message:"Account has successfully been created. You can now log in",type:"is-success",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8}),document.querySelector("#loginformRegister").classList.remove("is-active")):500===e.status?bulmaToast.toast({message:"An unknown error occured. Trying resending or checking your email for activation code.",type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8}):Object.keys(a).map(e=>{var t=a[e];try{var o=n.querySelectorAll(`input[name='${i[e]}']`)[0];o.setCustomValidity(t),o.classList.add("invalid"),o.reportValidity(),bulmaToast.toast({message:t,type:"is-danger",position:"bottom-center",duration:5e3,closeOnClick:!0,opacity:.8})}catch(e){}})}).catch(e=>{hideLoading(),window.csystem.failedToConnect()}))})}catch(e){}